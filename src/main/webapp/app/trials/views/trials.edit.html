<div class="col-xs-9">

    <div>
        <h2 style="display:inline-block" ng-bind="title"></h2>
        <span class="trial-edit-buttons answers">
            <label for="inp_to_selections">
                <input ng-class="{disabled: $state.includes('create')}" id="inp_to_selections" type="radio" data-ng-checked="{{trial.id}}" data-ui-sref="trials.detail({trialId:trial.id})">
                <span>Selections</span>
            </label>
        </span>
        <span class="errors right" ng-bind="errors"></span>
    </div>

    <div class="clear"></div>

    <form id="myForm" name="trialForm" ng-submit="uploadTrial(trial, trial.trialInfo.trialLogoPic)">

        <div class="form-group col-xs-3">

            <!-- Edit Trial Information -->
            <div class="simplePanel" data-ng-click="showSiteForm()">
                <h3>Trial Information</h3>
                <p class="edTrial">Edit Trial Information</p>
            </div>â€º

            <!-- Trial Sites List -->
            <div class="simplePanel">

                <h33>Trial Sites</h33>
                <span>
                    <input type="text" data-ng-model="search" placeholder="Trial Site Search...">
                    <button class="left btn btn-add-site" type="button" title="Add"
                            data-ng-click="initializeTrialSite();">
                        <span class="glyphicon glyphicon-plus"></span>
                    </button>
                </span>

                <ul class="trialLeaderSelect">
                    <li class="trialLeaderName"
                        data-ng-repeat="trialSite in trial.trialInfo.trialSites._embeddedItems | filter : search"
                        data-ng-click="showSiteForm(trialSite.id)">
                        <strong ng-bind="trialSite.siteDirector"></strong><br>
                        <small>
                            <span data-ng-if="trialSite.trialDirectAddress.address1.length" ng-bind="trialSite.trialDirectAddress.address1"></span>
                            <span data-ng-if="trialSite.trialDirectAddress.address2.length" ng-bind="trialSite.trialDirectAddress.address2"></span>
                            <span data-ng-if="trialSite.trialDirectAddress.address4.length" ng-bind="trialSite.trialDirectAddress.address3"></span>
                            <span data-ng-if="trialSite.trialDirectAddress.address4.length" ng-bind="trialSite.trialDirectAddress.address4"></span>
                            <span data-ng-if="trialSite.trialDirectAddress.address5.length" ng-bind="trialSite.trialDirectAddress.address5"></span>
                            <span data-ng-if="trialSite.trialDirectAddress.country.length" ng-bind="trialSite.trialDirectAddress.country"></span>
                        </small>
                    </li>
                </ul>

            </div>

        </div>


        <!-- Trial Info Start  -->

        <div data-td-id="trialInformationEditor" class="simplePanel col-xs-9"
             data-ng-hide="trialSiteId">

            <!-- Left Column, Trial Site Information -->
            <div class="trialLeaderBio">
                <!--
                    Trial Name
                -->
                <div class="trial-info-edit">
                    <div class="form-group">
                        <label for="trialInfo-description">Trial Name</label>
                        <span>
                            <input id="newTrialInput" name="tTitle" type="text" class="form-control"
                                   ng-model="trial.title" value="{{trial.title}}" required="">
                        </span>
                        <div ng-show="trialForm.$submitted || trialForm.tTitle.$touched">
                            <div class="errors" ng-show="trialForm.tTitle.$error.required">Please supply a title</div>
                        </div>
                    </div>
                </div>


                <!--
                    Trial SpecialistArea
                -->
                <div class="list-answers answers">
                    <label>Therapeutic Area</label>
                    <div class="clear"></div>

                    <label data-ng-repeat="specialistarea in specialistareas">
                        <input name="tTherapeuticArea" type="radio" data-ng-model="specialistarea.checked"
                               data-ng-click="chooseTherapeuticArea(specialistarea)" required="">
                        <span data-ng-bind="specialistarea.title"></span>
                        <div ng-show="trialForm.$submitted || trialForm.tTherapeuticArea.$empty">
                            <div class="errors" ng-show="trialForm.tTherapeuticArea.$error.required">Please specify a Therapeutic Area</div>
                        </div>
                    </label>
                </div>

                <div class="clear"></div>
            </div>


            <!-- Right Column, Trial Info-->
            <div class="trialSiteLocation">

                <!-- Trial Information Logo -->
                <div class="form-group">
                    <label class="trialImage">Trial Image/Logo</label>

                        <span class="trialLogoImage">
                            <input id="trialLogo" type="file" ngf-select ng-model="trial.trialInfo.trialLogoPic" name="file"
                                   accept="image/*" ngf-max-size="2MB" required ng-change="toggleTrialInfoDisplay()"
                                   ngf-model-invalid="errorFile">

                            <i ng-show="trialInfo.trialLogoPic.$error.required">*</i>
                            <i ng-show="trialInfo.trialLogoPic.$error.maxSize">File too large
                                {{errorFile.size / 1000000|number:1}}MB: max 2M</i>
                            <!-- If the model contains the trialLogoPic bytes then the user has just re-uploaded an image or else they've uploaded it for
                                 the first time
                                  Therefore because we don't save the image until later we can't reference /trialInfoImage/{{trial.id}}
                                  as the src to the image as it hasn't been saved/updated
                                  -->
                            <img ngf-thumbnail="trial.trialInfo.trialLogoPic" class="thumb" ng-click="toggleTrialInfoDisplay()" ng-if="trial.trialInfo.trialLogoPic">
                            <img data-ng-src="/trialInfoImage/{{trial.id}}" ng-if="!trialInfo.trialLogoPic && trial.id">
                            <div>
                                <button ng-click="trial.trialInfo.trialLogoPic = null;" ng-show="trial.trialInfo.trialLogoPic">Change Logo</button>
                            </div>
                        </span>
                </div>

            </div>


            <div class="clear"></div>


            <!-- Trial Summary -->
            <div class="trial-info-edit">
                <div class="form-group">
                    <label for="trialInfo-summary">Trial Summary</label>
                    <span>
                        <textarea id="trialInfo-summary" name="tSummary"
                                  data-ng-model="trialInfo.summary" class="trialFacility" required="">
                        </textarea>
                        <div ng-show="trialForm.$submitted || trialForm.tSummary.$touched">
                            <div class="errors" ng-show="trialForm.tSummary.$error.required">Please supply a summary</div>
                        </div>
                    </span>
                </div>
            </div>


            <!-- Trial Description -->
            <div class="trial-info-edit">
                <div class="form-group">
                    <label for="trialInfo-description">Full Description</label>
                    <span>
                        <textarea id="trialInfo-description" name="tDescription"
                                  data-ng-model="trialInfo.fullDescription" style="min-height: 25em" required>
                        </textarea>
                        <div ng-show="trialForm.$submitted || trialForm.tDescription.$touched">
                            <div class="errors" ng-show="trialForm.tDescription.$error.required">Please supply a full description</div>
                        </div>
                    </span>
                </div>
            </div>

        </div>
        <!-- Trial Info End  -->


        <!-- Trial Site Start -->
        <div class="form-group simplePanel col-xs-9" data-ng-repeat="trialSite in trial.trialInfo.trialSites._embeddedItems"
             data-ng-show="trialSiteId == trialSite.id">


            <div class="clear"></div>

            <!-- Left Column, Trial Facility Summaries -->
            <div class="trialLeaderBio">

                <div data-td-id="trialSiteEditor{{$index}}">

                    <!-- Trial Facility Name -->
                    <div class="form-group">
                        <label for="trial-site-facility-name{{$index}}">Trial Facility Name</label>
                        <input id="trial-site-facility-name{{$index}}" type="text" name="trial-site-director"
                               data-ng-model="trialSite.facilityName" size="31" required>
                    </div>

                    <!-- Trial Facility Description -->
                    <div class="form-group">
                        <label for="trial-site-facility-description{{$index}}">Trial Facility Description</label>
                        <span>
                            <textarea id="trial-site-facility-description{{$index}}" name="trial-site-summary"
                                      data-ng-model="trialSite.facilityDescription" required>
                            </textarea>
                        </span>
                    </div>

                    <!-- Trial Facility Image -->
                    <!--<div class="trial-site-logo">-->
                        <!--<label>Trial Facility Image</label>-->
                        <!--<p class="trialLeaderImage" style="background-image:url(/trialSiteImage/{{trialSite.id}})"></p>-->
                    <!--</div>-->

                    <div class="trial-site-logo">
                        <!-- -------------- -->
                        <!-- Trial Site Pic -->
                        <!-- -------------- -->
                        <label for="trial-site-logo{{$index}}">Trial Site Pic</label>
                        <input id="trial-site-logo{{$index}}" type="file" ngf-select ng-model="trialSite.sitePic"
                               name="siteFile" ng-change="toggleTrialSiteDisplay(trialSite)"
                               accept="image/*" ngf-max-size="2MB" required
                               ngf-model-invalid="errorFile">
                        <img data-ng-src="/trialSiteImage/{{trialSite.id}}" ng-if="!trialSite.sitePic && trialSite.id">
                        <i ng-show="trialSite.sitePic.$error.required">*required</i><br>
                        <i ng-show="trialSite.sitePic.$error.maxSize">File too large
                            {{errorFile.size / 1000000|number:1}}MB: max 2M</i>
                    </div>

                    <!-- Trial Facility Image REMOVE -->
                    <div class="form-group">
                        <span>
                            <img ngf-thumbnail="trialSite.sitePic" class="thumb"
                                 data-ng-click="toggleTrialSiteDisplay(trialSite)">
                        </span>
                        <button type="button" class="btn btn-remove" style="float:right;clear:both">
                            Remove Image
                        </button>
                    </div>


                    <div class="clear"></div>

                    <!-- Trial Facility Location (Google Map URL) -->
                    <div class="form-group">
                        <label for="trial-site-map{{$index}}">Trial Facility Location (Google Map URL)</label>
                        <span>
                            <input id="trial-site-map{{$index}}" type="text" name="trial-site-map"
                                   data-ng-model="trialSite.siteMap" size="31">
                        </span>
                    </div>


                </div>


            </div>

            <!-- Left Column, Trial Facility Address -->
            <div class="trialSiteLocation">

                <!-- Trial Site Address 1 -->
                <div class="form-group">
                    <label for="trial-site-address1{{$index}}">Address 1</label>
                    <span>
                        <input id="trial-site-address1{{$index}}" type="text" name="trial-site-address1"
                               data-ng-model="trialSite.trialDirectAddress.address1" size="31" required>
                    </span>
                </div>

                <!-- Trial Site Address 2 -->
                <div class="form-group">
                    <label for="trial-site-address2{{$index}}">Address 2</label>
                    <span>
                        <input id="trial-site-address2{{$index}}" type="text" name="trial-site-address2"
                               data-ng-model="trialSite.trialDirectAddress.address2" size="31">
                    </span>
                </div>

                <!-- Trial Site Address 3 -->
                <div class="form-group">
                    <label for="trial-site-address3{{$index}}">Town or City</label>
                    <span>
                        <input id="trial-site-address3{{$index}}" type="text" name="trial-site-address3"
                               data-ng-model="trialSite.trialDirectAddress.address3" size="31" required>
                    </span>
                </div>

                <!-- Trial Site Address 4 -->
                <div class="form-group">
                    <label for="trial-site-address4{{$index}}">State</label>
                    <span>
                        <input id="trial-site-address4{{$index}}" type="text" name="trial-site-address4"
                               data-ng-model="trialSite.trialDirectAddress.address4" size="31" required>
                    </span>
                </div>

                <!-- Trial Site Address 5 -->
                <div class="form-group">
                    <label for="trial-site-address5{{$index}}">ZIP Code</label>
                    <span>
                        <input id="trial-site-address5{{$index}}" type="text" name="trial-site-address5"
                               data-ng-model="trialSite.trialDirectAddress.address5" size="31" required>
                    </span>
                </div>

                <!-- Trial Site Address (Country) -->
                <div class="form-group">
                    <label for="trial-site-country{{$index}}">Country</label>
                    <span>
                        <input id="trial-site-country{{$index}}" type="text" name="trial-site-country"
                               data-ng-model="trialSite.trialDirectAddress.country" size="31" required>
                    </span>
                </div>


            </div>

            <div class="clear"></div>

        </div>
        <!-- Trial Site End -->
        <span class="trial-edit-buttons answers">
            <label for="input_save_trial">
                <input id="input_save_trial" type="submit" checked=checked>
                <span>Save Trial</span>
            </label>
        </span>

    </form>
</div>